<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="2021/12/13 Tangling analysis #  Overall task tangling #   ‚ùì CST is much more feedback driven than CO. Does this show up as M1 dynamics being less apparently autonomous? That is, is neural tangling higher in CST than CO?  ‚úîÔ∏è Tangling doesn&rsquo;t really appear to be much higher in CST than CO, suggesting that the feedback may be &ldquo;predictable&rdquo; most of the time. üí¨ Does tangling depend on the amount of data you use to check it?">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content="CO-CST tangling analysis">
<meta property="og:description" content="2021/12/13 Tangling analysis #  Overall task tangling #   ‚ùì CST is much more feedback driven than CO. Does this show up as M1 dynamics being less apparently autonomous? That is, is neural tangling higher in CST than CO?  ‚úîÔ∏è Tangling doesn&rsquo;t really appear to be much higher in CST than CO, suggesting that the feedback may be &ldquo;predictable&rdquo; most of the time. üí¨ Does tangling depend on the amount of data you use to check it?">
<meta property="og:type" content="article">
<meta property="og:url" content="http://example.org/neural-analyis-notes/20211214-tangling-analysis/"><meta property="article:section" content="neural-analyis-notes">
<title>CO-CST tangling analysis | CST Strategy Project Notes</title>
<link rel=manifest href=/manifest.json>
<link rel=icon href=/favicon.png type=image/x-icon>
<link rel=stylesheet href=/book.min.95d69eb6bad8b9707ff2b5d8d9e31ce70a1b84f2ed7ffaf665ffcf00aa7993bd.css integrity="sha256-ldaetrrYuXB/8rXY2eMc5wobhPLtf/r2Zf/PAKp5k70=" crossorigin=anonymous>
<script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.dc816db093bb4ddb54659068f360daf57abfce9dc12b21bdb96abe6875a0eac3.js integrity="sha256-3IFtsJO7TdtUZZBo82Da9Xq/zp3BKyG9uWq+aHWg6sM=" crossorigin=anonymous></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/><span>CST Strategy Project Notes</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li>
<a href=http://example.org/neural-analyis-notes/>Possible neural analyses to compare CO and CST</a>
<ul>
<li>
<a href=http://example.org/neural-analyis-notes/20211209-covariance-analysis/>CO-CST covariance analysis</a>
</li>
<li>
<a href=http://example.org/neural-analyis-notes/20211209-cis-analysis/>CO Condition independent signal analysis</a>
</li>
<li>
<a href=http://example.org/neural-analyis-notes/20211210-engagement-analysis/>CST neural engagement</a>
</li>
<li>
<a href=http://example.org/neural-analyis-notes/20211210-hold-analysis/>CO-CST hold time analysis</a>
</li>
<li>
<a href=http://example.org/neural-analyis-notes/20211214-tangling-analysis/ class=active>CO-CST tangling analysis</a>
</li>
</ul>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>CO-CST tangling analysis</strong>
<label for=toc-control>
<img src=/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#overall-task-tangling>Overall task tangling</a></li>
<li><a href=#timecourse-of-tangling>Timecourse of tangling</a></li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h1 id=20211213-tangling-analysis>
2021/12/13 Tangling analysis
<a class=anchor href=#20211213-tangling-analysis>#</a>
</h1>
<h2 id=overall-task-tangling>
Overall task tangling
<a class=anchor href=#overall-task-tangling>#</a>
</h2>
<ul>
<li>‚ùì CST is much more feedback driven than CO. Does this show up as M1 dynamics being less apparently autonomous? That is, is neural tangling higher in CST than CO?
<ul>
<li>‚úîÔ∏è Tangling doesn&rsquo;t really appear to be much higher in CST than CO, suggesting that the feedback may be &ldquo;predictable&rdquo; most of the time.</li>
<li>üí¨ Does tangling depend on the amount of data you use to check it? Right now I&rsquo;m thinking it probably does, but I can&rsquo;t be sure without simulation</li>
</ul>
</li>
</ul>
<p>In Russo et al. 2018, they found that M1 exhibited low &ldquo;tangling&rdquo;. This metric basically measures how predictable the dynamics of neural activity are&ndash;if you&rsquo;re in one neural state, low tangling would indicate that the neural state on the next time point is highly consistent. On the other hand, high tangling at a particular time point indicates that the next neural state is somewhat unpredictable&ndash;basically the neural trajectories that travel through or near that neural state are &ldquo;tangled&rdquo;. A purely autonomous neural dynamical system should exhibit low tangling (assuming we have a complete or near complete view of the neural state space)&ndash;thus, high tangling should indicate that a system&rsquo;s dynamics are non-autonomous, either through time-varying dynamics, or more likely, via inputs to the system.</p>
<p>As a reminder, tangling is defined as</p>
<p>$$ Q(t) = \underset{\tau}\max( \dfrac {\dot{x}<em>{\tau} - \dot{x}</em>{t}} {x_{\tau}-x_t} ) $$</p>
<p>where $x_{t}$ corresponds to the neural state at timepoint $t$ and $\dot{x}_t$ corresponds to the time derivative of the neural state at time $t$. Tangling ($Q(t)$) is thus maximal when two neural states are close together, but their time derivatives are quite different.</p>
<p>Because CST is more feedback-driven than CO, you would expect that M1 neural dynamics shouldn&rsquo;t be as autonomous-like in CST as we know it is in CO. This could mean that we should expect higher tangling in CST than CO. To check this, we ran an analysis of neural tangling in the 8 dimensions of neural activity that explain the most variance for both CO and CST. In both cases, we smoothed the neural activity using a Gaussian kernel with standard deviation of 75 ms and soft normalized it (with $\alpha=5$). The time periods in which we checked tangling was between the go cue time and the end of each trial.</p>
<p><img src=figs/20211207_Ford20180627_tangling_density_fullCST_longCO.png alt="Ford tangling"></p>
<p><img src=figs/20211207_Earl20190716_tangling_density.png alt="Earl tangling"></p>
<p>Plotting an estimated probability density of tangling values for each task shows that there&rsquo;s a great deal of overlap in tangling distributions, which seems quite unexpected, given how feedback driven CST is. One possibility is that including the whole trial during the CO task includes more than just the ballistic, feedforward part of the movement. In the time right after go cue, there are likely some inputs to M1 telling it which target to prepare and execute a movement for. Likewise, near the end of a CO movement, a monkey will often adjust the trajectory of the hand based on errors in the reach. Thus one modification may be to limit the CO tangling analysis to the middle portion of the trial, after movement onset and before any possible corrections.</p>
<p><img src=figs/20211207_Ford20180627_tangling_density_fullCST.png alt="Ford tangling with ballistic CO"></p>
<p>From this reduction in CO trial time, there is slightly more difference between the two task distributions, though they still overlap significantly.</p>
<p>Another possible consideration is that we search for highly tangled pairs of states in a much larger set of timepoints with CST, given that CST has 6 second trials and there are many more of them. This may artificially inflate tangling, especially in the presence of noisy neural state. We can test this by limiting the CST trials to one specific $\lambda$ (in the following figure, $\lambda = 3.3$, still taking only the middle part of the CO trials)</p>
<p><img src=figs/20211207_Ford20180627_tangling_density_lambda3.3.png alt="Ford tangling with ballistic CO"></p>
<p>Once again, the distributions are highly overlapping. We&rsquo;ll probably have to be careful about the amount of data we use to compute tangling going forward, or we will need to find a good way to trial average data across the CST dataset (possibly through a submovement decomposition?).</p>
<p>The fact that tangling is similar between CO and CST is quite interesting. It suggests that while CST is quite feedback-driven, the dynamics of M1 remain mostly predictable. This predictability may stem from the fact that as a whole, the monkey-CST system has predictable dynamics, apart from sensory and motor noise at the interface between the monkey and the computer. Another possibility is that M1 remains untangled <em>most</em> of the time, but gets tangled at times when it integrates feedback to make a motor adjustment.</p>
<h2 id=timecourse-of-tangling>
Timecourse of tangling
<a class=anchor href=#timecourse-of-tangling>#</a>
</h2>
<ul>
<li>‚ùì Does the timecourse of tangling over a CST or CO trial reveal anything about corrective movements? Perhaps tangling increases before corrective movements or after apparent errors to signify introduction of unexpected feedback.
<ul>
<li>üí¨ May need to develop corrective movement detection to enable trial averaging, as well as apparent error detection (for CST, this might equate to moving the hand in the wrong direction)</li>
</ul>
</li>
</ul>
<p>If tangling is generally low in M1 because the monkey is intermittently integrating feedback information, then it may be possible to see this by looking at the timecourse of tangling through CO and CST trials.</p>
<p>Below is a representation of an example CO trial.</p>
<p><img src=figs/trials/20211208_Ford20180627_COtangling_trial20.png alt="Ford CO tangling trial 20"></p>
<p>In this figure, the left column shows the timecourse of tangling (top, yellow is highest tangling), hand kinematics, and the 8 dimensions of M1 neural state. Middle column shows the hand movement in the x-y plane, with points colored by tangling (same color map as top left). Right plot shows the top three dimensions of M1 activity, colored by tangling.</p>
<p>One highly noticable aspect of this trial is the late correction that the monkey makes to stay in the final target&ndash;this correction is surrounded by a period of high tangling, as we might expect. However, not all CO trials are this readily interpretable. For example, here is a trial in which tangling appears to be high during the main movement.</p>
<p><img src=figs/trials/20211208_Ford20180627_COtangling_trial81.png alt="Ford CO tangling trial 81"></p>
<p>Moving onto CST trials, interpretation is (as always) a little bit trickier. Below are representations of a few CST trials.</p>
<p><img src=figs/trials/20211208_Ford20180627_CSTtangling_trial271.png alt="Ford CST tangling trial 271"></p>
<p><img src=figs/trials/20211208_Ford20180627_CSTtangling_trial292.png alt="Ford CO tangling trial 292"></p>
<p>This representation of the trial is the same as the CO plots, with the exception that the middle plot is replaced by a sensorimotor plot, showing the hand position plotted against cursor position, highlighting the when the two are and are not in direct opposition.</p>
<p>It&rsquo;s hard to say anything for sure from these plots, but it does seem like larger movements in general have lower tangling. This might be due to the neural state reaching out from the tangled ball in the center (right plot), but it&rsquo;s not entirely clear. We maybe have to come up with some submovement decomposition over which to average neural traces before we can interpret tangling in this task.</p>
<p>Find more figs/trials folder.</p>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#overall-task-tangling>Overall task tangling</a></li>
<li><a href=#timecourse-of-tangling>Timecourse of tangling</a></li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>