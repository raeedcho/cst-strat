<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="2021/12/09 CO-CST covariance analysis #  For neural covariance analysis, we have a number of possible questions:
 ‚ùì Because CST has smaller movements, does neural variance also decrease as much as you would expect?  üìä Analysis: compare total neural variance between CO and CST ‚úîÔ∏è CST usually has smaller variance than CO, but unclear yet if it&rsquo;s what we would expect from smaller movements ‚ùì Remiaining question: is this variance solely due to smaller movements?">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content="CO-CST covariance analysis">
<meta property="og:description" content="2021/12/09 CO-CST covariance analysis #  For neural covariance analysis, we have a number of possible questions:
 ‚ùì Because CST has smaller movements, does neural variance also decrease as much as you would expect?  üìä Analysis: compare total neural variance between CO and CST ‚úîÔ∏è CST usually has smaller variance than CO, but unclear yet if it&rsquo;s what we would expect from smaller movements ‚ùì Remiaining question: is this variance solely due to smaller movements?">
<meta property="og:type" content="article">
<meta property="og:url" content="http://example.org/neural-analyis-notes/20211209-covariance-analysis/"><meta property="article:section" content="neural-analyis-notes">
<title>CO-CST covariance analysis | CST Strategy Project Notes</title>
<link rel=manifest href=/manifest.json>
<link rel=icon href=/favicon.png type=image/x-icon>
<link rel=stylesheet href=/book.min.95d69eb6bad8b9707ff2b5d8d9e31ce70a1b84f2ed7ffaf665ffcf00aa7993bd.css integrity="sha256-ldaetrrYuXB/8rXY2eMc5wobhPLtf/r2Zf/PAKp5k70=" crossorigin=anonymous>
<script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.dc816db093bb4ddb54659068f360daf57abfce9dc12b21bdb96abe6875a0eac3.js integrity="sha256-3IFtsJO7TdtUZZBo82Da9Xq/zp3BKyG9uWq+aHWg6sM=" crossorigin=anonymous></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/><span>CST Strategy Project Notes</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li>
<a href=http://example.org/neural-analyis-notes/>Possible neural analyses to compare CO and CST</a>
<ul>
<li>
<a href=http://example.org/neural-analyis-notes/20211209-covariance-analysis/ class=active>CO-CST covariance analysis</a>
</li>
<li>
<a href=http://example.org/neural-analyis-notes/20211209-cis-analysis/>CO Condition independent signal analysis</a>
</li>
<li>
<a href=http://example.org/neural-analyis-notes/20211210-engagement-analysis/>CST neural engagement</a>
</li>
<li>
<a href=http://example.org/neural-analyis-notes/20211210-hold-analysis/>CO-CST hold time analysis</a>
</li>
<li>
<a href=http://example.org/neural-analyis-notes/20211214-tangling-analysis/>CO-CST tangling analysis</a>
</li>
</ul>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>CO-CST covariance analysis</strong>
<label for=toc-control>
<img src=/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#neural-variance>Neural Variance</a></li>
<li><a href=#neural-dimensionality>Neural dimensionality</a>
<ul>
<li><a href=#gpfa-dimensionality-estimation>GPFA dimensionality estimation</a></li>
<li><a href=#hold-time-analyses>Hold time analyses</a></li>
</ul>
</li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h1 id=20211209-co-cst-covariance-analysis>
2021/12/09 CO-CST covariance analysis
<a class=anchor href=#20211209-co-cst-covariance-analysis>#</a>
</h1>
<p>For neural covariance analysis, we have a number of possible questions:</p>
<ul>
<li>‚ùì Because CST has smaller movements, does neural variance also decrease as much as you would expect?
<ul>
<li>üìä Analysis: compare total neural variance between CO and CST</li>
<li>‚úîÔ∏è CST usually has smaller variance than CO, but unclear yet if it&rsquo;s what we would expect from smaller movements</li>
<li>‚ùì Remiaining question: is this variance solely due to smaller movements? Not sure how to address this question though.</li>
</ul>
</li>
<li>‚ùì CST seems like a more complex task than CO&ndash;does this mean that neural activity explores more dimensions?
<ul>
<li>üìä compare CO and CST covariance rank (i.e. dimensionality), using participation ratio, parallel analysis, and GPFA cross-validated log-likelihood
<ul>
<li>‚úîÔ∏è CST does not seem to have much higher dimensionality, but activity is much closer to noise floor</li>
<li>üí¨ Three methods of dimensionality estimation (participation ratio, parallel analysis, and GPFA cross-validated log-likelihood) give differing results</li>
</ul>
</li>
</ul>
</li>
<li>‚ùì How much do CST and CO overlap in the neural manifold?
<ul>
<li>üìä compare neural covariance dimensions between CO and CST, using subspace overlap or principle angles</li>
</ul>
</li>
</ul>
<p>I examined the first two questions together, during the movement period of both CO and CST (figures below). Important to note: I calculated all of these after softnorming neural activity within each task ($\alpha$=5). No smoothing applied. Applying these techniques without the softnorm gives similar results for variance, though parallel analysis results are noisier (probably due to high variability of a few neurons). Reasonable levels of smoothing doesn&rsquo;t change any of these results much, though I would guess that oversmoothing data would decrease dimensionality.</p>
<p><img src=figs/softnormed/20211203_Earl20190716_COCSTmove_vardim_comparison-01.png alt="Earl Movement variance/dimensionality comparison"></p>
<p><img src=figs/softnormed/20211203_Ford20180627_COCSTmove_vardim_comparison-01.png alt="Ford Movement variance/dimensionality comparison"></p>
<h2 id=neural-variance>
Neural Variance
<a class=anchor href=#neural-variance>#</a>
</h2>
<p>Despite the within-task softnorm, the total neural variance seems much lower for CST than CO (top plots, CO in red, CST in black). Variance for individual lambdas of the CST (solid line) doesn&rsquo;t seem to be much different from the variance over all lambdas (black dashed line). Remaining question: is this difference in variance more or less than what we would expect from the different kinematics of the two tasks? CST movements are much smaller than CO movements on average, so we might expect a much lower neural variance to start with.</p>
<h2 id=neural-dimensionality>
Neural dimensionality
<a class=anchor href=#neural-dimensionality>#</a>
</h2>
<p>The same plots above show two measures of dimensionality: the participation ratio, which a measure of how flat the eigenspectrum of a covariance matrix is (flat eigenspectrum would have PR equal to the number of neurons), and parallel analysis dimensionality, which constructs a null distribution of eigenspectra by shuffling neural activity independently across time. The upshot is that PR says that the eigenspectra of both tasks are remarkably flat (when neurons are softnormed at least), but PA suggests that both tasks have significant covariance in only a few dimensions. Notably, when evaluated at individual $\lambda$, the PA dimensionality (black solid line) is very similar to the CO dimensionality (red dashed line), while CST dimensionality when evaluated over all $\lambda$ (black dashed line) is notably higher (though unclear if this difference is statistically significant). The most mundane explanation for this difference is that when you add more data, you get higher estimated dimensionality (see Surya Ganguli&rsquo;s work and Ryan Williamson&rsquo;s work). A less mundane explanation might be that you use different, not fully overlapping dimensions of neural activity at different $\lambda$, but this claim seems unlikely.</p>
<p>Below are some eigenspectra for CO and CST movement-time activity for both monkeys, with 95th percentile null distribution from parallel analysis.</p>
<p><img src=figs/softnormed/20211203_Earl20190716_COmove_eigenspectrum_with_PA-01.png alt="Earl CO movement-time eigenspectrum"></p>
<p><img src=figs/softnormed/20211203_Earl20190716_CSTmove_eigenspectrum_with_PA-01.png alt="Earl CST movement-time eigenspectrum"></p>
<p><img src=figs/softnormed/20211203_Ford20180627_COmove_eigenspectrum_with_PA-01.png alt="Ford CO movement-time eigenspectrum"></p>
<p><img src=figs/softnormed/20211203_Ford20180627_CSTmove_eigenspectrum_with_PA-01.png alt="Ford CST movement-time eigenspectrum"></p>
<h3 id=gpfa-dimensionality-estimation>
GPFA dimensionality estimation
<a class=anchor href=#gpfa-dimensionality-estimation>#</a>
</h3>
<p>We can also evaluate the dimensionality using GPFA cross-validated log-likelihood across number of factors used to describe the data. For this dataset, it has been a little tricky to fairly compare CO and CST, since generally there&rsquo;s so much more CST data than CO. But just pushing the data through the pipeline, we get these figures (note that these data were not softnormed before running GPFA, and this particular analysis takes hours to run):</p>
<p><img src=figs/non-normed/gpfa/Ford_20180627_CO_gpfa_LLvDim-01.png alt="Ford CO GPFA cross-validated log-likelihood"></p>
<p><img src=figs/non-normed/gpfa/Ford_20180627_CST_full_gpfa_LLvDim-01.png alt="Ford CST GPFA cross-validated log-likelihood"></p>
<p>This suggests that CST does indeed have higher dimensionality than CO. However, when we select only the number of CST trials (each 6 seconds long) to match the total number of time points across tasks, we get this for CST:</p>
<p><img src=figs/non-normed/gpfa/Ford_20180627_CST_timepointmatch_gpfa_LLvDim-01.png alt="Ford CST GPFA cross-validated log-likelihood"></p>
<p>And that seems to suggest a similar dimensionality between the two tasks.</p>
<p>But we can also match both number of trials and number of timepoints in each tasks, subselecting one 0.5 s portion of each CST trial to match the CO trials:</p>
<p><img src=figs/non-normed/gpfa/Ford_20180627_CST_trialmatch_gpfa_LLvDim-01.png alt="Ford CST trial-matched GPFA cross-validated log-likelihood"></p>
<p>And that gives something mostly nonsensical. Haven&rsquo;t quite figured this one out yet, but I think the overall story is just that CST and CO have similar dimensionality, and everything weird here is just measurement error.</p>
<h3 id=hold-time-analyses>
Hold time analyses
<a class=anchor href=#hold-time-analyses>#</a>
</h3>
<p>I also ran all of these analyses (except the GPFA analysis) on the hold time before movement in both tasks. Here are those figures:</p>
<p><img src=figs/softnormed/20211203_Earl20190716_COCSThold_vardim_comparison-01.png alt="Earl hold variance/dimensionality comparison"></p>
<p><img src=figs/softnormed/20211203_Ford20180627_COCSThold_vardim_comparison-01.png alt="Ford hold variance/dimensionality comparison"></p>
<p><img src=figs/softnormed/20211203_Earl20190716_COhold_eigenspectrum_with_PA-01.png alt="Earl CO hold-time eigenspectrum"></p>
<p><img src=figs/softnormed/20211203_Earl20190716_CSThold_eigenspectrum_with_PA-01.png alt="Earl CST hold-time eigenspectrum"></p>
<p><img src=figs/softnormed/20211203_Ford20180627_COhold_eigenspectrum_with_PA-01.png alt="Ford CO hold-time eigenspectrum"></p>
<p><img src=figs/softnormed/20211203_Ford20180627_CSThold_eigenspectrum_with_PA-01.png alt="Ford CST hold-time eigenspectrum"></p>
<p>The scales are a little bit off (note that variance y-axis has quite tiny range compared to previous figures), but basically, variance and dimensionality were pretty much the same in the hold period of CO and CST. Also, Ford&rsquo;s neural data during hold period is quite noisy, as shown by his hold-time eigenspectra being close to the noise.</p>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#neural-variance>Neural Variance</a></li>
<li><a href=#neural-dimensionality>Neural dimensionality</a>
<ul>
<li><a href=#gpfa-dimensionality-estimation>GPFA dimensionality estimation</a></li>
<li><a href=#hold-time-analyses>Hold time analyses</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>